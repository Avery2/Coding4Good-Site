<!doctype html>
<html>
<head>
    <% include template/head.ejs %>
    <script>
      $(function () {
        $("#login-form").submit(function () {
          if (($("#password").val() == '') | ($("#email").val() == '')) {
            $("#error-msg").html('Please fill out all the fields');
            return false;
          }
          $.ajax({
            url: "/api/login",
            method: "POST",
            dataType: "json",
            data: {
              email: $("#email").val(),
              password: $("#password").val()
            },
            success: function (valid) {
              if(valid){
                window.location.href = "/profile";
              }
              else{
                $("#error-msg").html('Your username or password is wrong, please try again!');
              }
            },
            error: function (jqXHR, textStatus, errorThrown) {
              $("#error-msg").html(jqXHR.responseJSON);
            }
          });
          return false;
        });
      });
    </script>

</head>

<body>

<% include template/nav.ejs %>

<div class="login-signup">
    <p class="error-msg" id="error-msg"></p>
    <form id="login-form">
        <div class="input-group login-signup-input">
            <div class="input-group-addon">Email:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
            <input class="form-control" type="text" id="email" placeholder="Email">
        </div>
        <div class="input-group login-signup-input">
            <div class="input-group-addon">Password:</div>
            <input class="form-control" type="password" id="password" placeholder="Password">
        </div>
        <p>I don't have an account yet, <a href="signup">sign me up!</a></p>
    </form>
    <button type="submit" form="login-form" class="btn login-signup-btn primary-button">Login</button>
</div>

<% include template/footer.ejs %>
</body>
</html>
